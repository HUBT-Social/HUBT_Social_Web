import {
  BookOutlined,
  CalendarOutlined,
  DeleteOutlined,
  DownloadOutlined,
  EditOutlined,
  FileTextOutlined,
  FilterOutlined,
  PlusOutlined,
  ReloadOutlined,
  SearchOutlined,
  UploadOutlined
} from '@ant-design/icons';
import {
  Badge,
  Button,
  Card,
  Col,
  Divider,
  Form,
  Input,
  message,
  Modal,
  Row,
  Select,
  Space,
  Spin,
  Table,
  Tooltip,
  Typography,
  Upload
} from 'antd';
import type { ColumnsType } from 'antd/es/table';
import React, { useState } from 'react';
import { useDispatch, useSelector } from 'react-redux';
import {
  addExam,
  deleteExam,
  fetchExams,
  selectExamsLoading,
  selectFilteredExams,
  selectPagination,
  setExams,
  setFilter,
  setPagination,
  updateExam
} from '../../../store/slices/examSlice';
import { AppDispatch } from '../../../store/store';
import { Exam } from '../../../types/exams';

const { Search } = Input;
const { TextArea } = Input;
const { Title, Text } = Typography;

const ExamList: React.FC = () => {
  const dispatch = useDispatch<AppDispatch>();
  const exams = useSelector(selectFilteredExams);
  const loading = useSelector(selectExamsLoading);
  const pagination = useSelector(selectPagination);
  const [searchTerm, ] = useState<string>('');
  const [filterStatus, setFilterStatus] = useState<string>('all');
  const [filterMajor, setFilterMajor] = useState<string>('');
  const [isModalVisible, setIsModalVisible] = useState(false);
  const [editingExam, setEditingExam] = useState<Exam | null>(null);
  const [form] = Form.useForm();
  const [formLoading, setFormLoading] = useState<boolean>(false);

  const majorOptions = [
    { label: 'üìä To√°n h·ªçc', value: 'To√°n', color: '#1890ff' },
    { label: '‚öõÔ∏è V·∫≠t l√Ω', value: 'L√Ω', color: '#52c41a' },
    { label: 'üß™ H√≥a h·ªçc', value: 'H√≥a', color: '#fa8c16' },
    { label: 'üìö VƒÉn h·ªçc', value: 'VƒÉn', color: '#eb2f96' },
    { label: 'üåç ƒê·ªãa l√Ω', value: 'ƒê·ªãa', color: '#13c2c2' },
  ];

  const statusConfig = {
    draft: { color: '#faad14', text: 'Nh√°p' },
    pending: { color: '#1890ff', text: 'ƒêang x·ª≠ l√Ω' },
    approved: { color: '#52c41a', text: 'ƒê√£ duy·ªát' },
  };

//   useEffect(() => {
//     dispatch(fetchExams({ page: pagination.current, pageSize: pagination.pageSize, major: filterMajor }));
//   }, [dispatch, pagination.current, pagination.pageSize, filterMajor]);

  // const handleTableChange = (pagination: any) => {
  //   dispatch(setPagination({ current: pagination.current, pageSize: pagination.pageSize }));
  // };

  const filteredExams = exams.filter(exam => {
    const matchesSearch = !searchTerm || 
      exam.title.toLowerCase().includes(searchTerm.toLowerCase()) ||
      exam.description.toLowerCase().includes(searchTerm.toLowerCase()) ||
      exam.major.toLowerCase().includes(searchTerm.toLowerCase());
    const matchesStatus = filterStatus === 'all' || exam.status === filterStatus;
    return matchesSearch && matchesStatus;
  });

  const formatDate = (dateString: string) => {
    return new Date(dateString).toLocaleDateString('vi-VN', {
      year: 'numeric',
      month: '2-digit',
      day: '2-digit',
      hour: '2-digit',
      minute: '2-digit'
    });
  };

  const columns: ColumnsType<Exam> = [
    { 
      title: (
        <Space>
          <FileTextOutlined />
          Ti√™u ƒë·ªÅ
        </Space>
      ), 
      dataIndex: 'title', 
      key: 'title', 
      sorter: (a, b) => a.title.localeCompare(b.title),
      render: (text: string) => (
        <Text strong className="text-gray-800">{text}</Text>
      )
    },
    { 
      title: 'M√¥ t·∫£', 
      dataIndex: 'description', 
      key: 'description',
      ellipsis: true,
      render: (text: string) => (
        <Tooltip title={text}>
          <Text type="secondary">{text}</Text>
        </Tooltip>
      )
    },
    { 
      title: (
        <Space>
          <BookOutlined />
          M√¥n h·ªçc
        </Space>
      ), 
      dataIndex: 'major', 
      key: 'major', 
      sorter: (a, b) => a.major.localeCompare(b.major),
      render: (major: string) => {
        const majorOption = majorOptions.find(opt => opt.value === major);
        return (
          <Badge 
            color={majorOption?.color || '#666'} 
            text={majorOption?.label || major}
          />
        );
      }
    },
    { 
      title: 'T·ªáp tin', 
      dataIndex: 'fileName', 
      key: 'fileName',
      render: (fileName: string) => (
        <Space>
          <FileTextOutlined className="text-blue-500" />
          <Text code>{fileName}</Text>
        </Space>
      )
    },
    { 
      title: (
        <Space>
          <CalendarOutlined />
          Ng√†y t·∫°o
        </Space>
      ), 
      dataIndex: 'createdDate', 
      key: 'createdDate', 
      sorter: (a, b) => new Date(a.createdDate).getTime() - new Date(b.createdDate).getTime(),
      render: (date: string) => (
        <Text type="secondary">
          {formatDate(date)}
        </Text>
      )
    },
    { 
      title: 'Tr·∫°ng th√°i', 
      dataIndex: 'status', 
      key: 'status', 
      filters: [
        { text: 'Nh√°p', value: 'draft' },
        { text: 'ƒêang x·ª≠ l√Ω', value: 'pending' },
        { text: 'ƒê√£ duy·ªát', value: 'approved' },
      ], 
      onFilter: (value: any, record) => record.status === value,
      render: (status: string) => (
        <Badge 
          color={statusConfig[status as keyof typeof statusConfig]?.color}
          text={statusConfig[status as keyof typeof statusConfig]?.text}
        />
      )
    },
    {
      title: 'Thao t√°c',
      key: 'action',
      width: 180,
      render: (_, record) => (
        <Space size="small">
          <Tooltip title="Ch·ªânh s·ª≠a">
            <Button 
              type="primary" 
              ghost
              icon={<EditOutlined />} 
              onClick={() => handleEdit(record)}
              size="small"
            />
          </Tooltip>
          <Tooltip title="X√≥a">
            <Button 
              danger
              ghost
              icon={<DeleteOutlined />} 
              onClick={() => handleDelete(record.id!)}
              size="small"
            />
          </Tooltip>
          <Tooltip title="T·∫£i xu·ªëng">
            <Button 
              type="default"
              ghost
              icon={<DownloadOutlined />}
              size="small"
              className="text-green-600 border-green-600 hover:text-green-700 hover:border-green-700"
            />
          </Tooltip>
        </Space>
      ),
    },
  ];

  const handleEdit = (exam: Exam) => {
    setEditingExam(exam);
    setIsModalVisible(true);
    form.setFieldsValue({
      title: exam.title,
      description: exam.description,
      major: exam.major,
      status: exam.status,
    });
  };

  const handleDelete = (id: string) => {
    Modal.confirm({
      title: 'X√°c nh·∫≠n x√≥a',
      content: 'B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a ƒë·ªÅ thi n√†y? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c!',
      okText: 'X√≥a',
      okType: 'danger',
      cancelText: 'H·ªßy',
      icon: <DeleteOutlined className="text-red-500" />,
      onOk: () => {
        dispatch(deleteExam(id)).unwrap().then(() => {
          message.success('ƒê·ªÅ thi ƒë√£ ƒë∆∞·ª£c x√≥a th√†nh c√¥ng');
        }).catch((error) => {
          message.error(error || 'ƒê√£ x·∫£y ra l·ªói khi x√≥a ƒë·ªÅ thi');
        });
      },
    });
  };

  const handleAddOrUpdate = (values: any) => {
    setFormLoading(true);
    const formData = new FormData();
    formData.append('Title', values.title);
    formData.append('Description', values.description);
    formData.append('Major', values.major);
    if (values.status) formData.append('status', values.status);
    if (values.file) formData.append('File', values.file.file.originFileObj);

    if (editingExam) {
      dispatch(updateExam({ 
        id: editingExam.id!, 
        title: values.title, 
        description: values.description, 
        status: values.status, 
        major: values.major 
      }))
        .unwrap()
        .then(() => {
          message.success('ƒê·ªÅ thi ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t th√†nh c√¥ng');
          setIsModalVisible(false);
          setEditingExam(null);
          form.resetFields();
        })
        .catch((error) => {
          message.error(error || 'ƒê√£ x·∫£y ra l·ªói khi c·∫≠p nh·∫≠t ƒë·ªÅ thi');
        })
        .finally(() => setFormLoading(false));
    } else {
      dispatch(addExam({
        title: values.title,
        description: values.description,
        major: values.major,
        file: values.file?.file.originFileObj,
      }))
        .unwrap()
        .then(() => {
          message.success('ƒê·ªÅ thi ƒë√£ ƒë∆∞·ª£c th√™m th√†nh c√¥ng');
          setIsModalVisible(false);
          form.resetFields();
        })
        .catch((error) => {
          message.error(error || 'ƒê√£ x·∫£y ra l·ªói khi th√™m ƒë·ªÅ thi');
        })
        .finally(() => setFormLoading(false));
    }
  };

  const handleFilterChange = (value: string) => {
    setFilterStatus(value);
    dispatch(setFilter({ status: value, searchTerm, major: filterMajor }));
  };

  const handleMajorFilterChange = (value: string) => {
    setFilterMajor(value);
    dispatch(fetchExams({ page: pagination.current, pageSize: pagination.pageSize, major: value }));
    dispatch(setFilter({ major: value, searchTerm, status: filterStatus }));
  };

  const handleResetExams = () => {
    const fakeExams: Exam[] = [
  {
    id: "1",
    title: "ƒê·ªÅ thi Gi·∫£i t√≠ch 1 - K·ª≥ thi cu·ªëi k·ª≥",
    description: "ƒê·ªÅ thi cu·ªëi k·ª≥ m√¥n Gi·∫£i t√≠ch 1 d√†nh cho sinh vi√™n nƒÉm nh·∫•t kh·ªëi ng√†nh K·ªπ thu·∫≠t",
    fileName: "calculus_1_final_exam.pdf",
    major: "To√°n",
    createdDate: "2025-06-01T10:00:00Z",
    status: "approved",
  },
  {
    id: "2",
    title: "ƒê·ªÅ thi V·∫≠t l√Ω ƒê·∫°i c∆∞∆°ng A1",
    description: "ƒê·ªÅ thi gi·ªØa k·ª≥ m√¥n V·∫≠t l√Ω ƒê·∫°i c∆∞∆°ng A1 cho sinh vi√™n kh·ªëi ng√†nh K·ªπ thu·∫≠t",
    fileName: "general_physics_midterm.pdf",
    major: "L√Ω",
    createdDate: "2025-06-02T14:30:00Z",
    status: "pending",
  },
  {
    id: "3",
    title: "ƒê·ªÅ thi H√≥a h·ªçc ƒê·∫°i c∆∞∆°ng",
    description: "ƒê·ªÅ thi cu·ªëi k·ª≥ m√¥n H√≥a h·ªçc ƒê·∫°i c∆∞∆°ng d√†nh cho sinh vi√™n khoa H√≥a h·ªçc",
    fileName: "general_chemistry_final.pdf",
    major: "H√≥a",
    createdDate: "2025-06-03T09:15:00Z",
    status: "approved",
  },
  {
    id: "4",
    title: "ƒê·ªÅ thi Ng·ªØ vƒÉn ƒê·∫°i c∆∞∆°ng",
    description: "ƒê·ªÅ thi cu·ªëi k·ª≥ m√¥n Ng·ªØ vƒÉn ƒê·∫°i c∆∞∆°ng - M√¥n h·ªçc c∆° s·ªü chung",
    fileName: "literature_general_final.pdf",
    major: "VƒÉn",
    createdDate: "2025-06-04T16:45:00Z",
    status: "draft",
  },
  {
    id: "5",
    title: "ƒê·ªÅ thi ƒê·ªãa l√Ω Kinh t·∫ø",
    description: "ƒê·ªÅ thi gi·ªØa k·ª≥ m√¥n ƒê·ªãa l√Ω Kinh t·∫ø d√†nh cho sinh vi√™n khoa ƒê·ªãa l√Ω",
    fileName: "economic_geography_midterm.pdf",
    major: "ƒê·ªãa",
    createdDate: "2025-06-05T11:20:00Z",
    status: "pending",
  },
  {
    id: "6",
    title: "ƒê·ªÅ thi X√°c su·∫•t Th·ªëng k√™",
    description: "ƒê·ªÅ thi cu·ªëi k·ª≥ m√¥n X√°c su·∫•t Th·ªëng k√™ cho sinh vi√™n kh·ªëi ng√†nh Kinh t·∫ø",
    fileName: "probability_statistics_final.pdf",
    major: "To√°n",
    createdDate: "2025-06-06T13:00:00Z",
    status: "approved",
  },
  {
    id: "7",
    title: "ƒê·ªÅ thi C∆° h·ªçc L√Ω thuy·∫øt",
    description: "ƒê·ªÅ thi cu·ªëi k·ª≥ m√¥n C∆° h·ªçc L√Ω thuy·∫øt d√†nh cho sinh vi√™n ng√†nh V·∫≠t l√Ω",
    fileName: "theoretical_mechanics_final.pdf",
    major: "L√Ω",
    createdDate: "2025-06-07T08:30:00Z",
    status: "draft",
  },
  {
    id: "8",
    title: "ƒê·ªÅ thi H√≥a h·ªçc Ph√¢n t√≠ch",
    description: "ƒê·ªÅ thi gi·ªØa k·ª≥ m√¥n H√≥a h·ªçc Ph√¢n t√≠ch cho sinh vi√™n nƒÉm th·ª© hai khoa H√≥a",
    fileName: "analytical_chemistry_midterm.pdf",
    major: "H√≥a",
    createdDate: "2025-06-08T15:10:00Z",
    status: "pending",
  },
  {
    id: "9",
    title: "ƒê·ªÅ thi VƒÉn h·ªçc Vi·ªát Nam Hi·ªán ƒë·∫°i",
    description: "ƒê·ªÅ thi cu·ªëi k·ª≥ m√¥n VƒÉn h·ªçc Vi·ªát Nam Hi·ªán ƒë·∫°i - Khoa Ng·ªØ vƒÉn",
    fileName: "modern_vietnamese_literature_final.pdf",
    major: "VƒÉn",
    createdDate: "2025-06-09T12:45:00Z",
    status: "approved",
  },
  {
    id: "10",
    title: "ƒê·ªÅ thi ƒê·ªãa l√Ω T·ª± nhi√™n Vi·ªát Nam",
    description: "ƒê·ªÅ thi cu·ªëi k·ª≥ m√¥n ƒê·ªãa l√Ω T·ª± nhi√™n Vi·ªát Nam cho sinh vi√™n chuy√™n ng√†nh ƒê·ªãa l√Ω",
    fileName: "vietnam_physical_geography_final.pdf",
    major: "ƒê·ªãa",
    createdDate: "2025-06-10T10:15:00Z",
    status: "draft",
  },
  {
    id: "11",
    title: "ƒê·ªÅ thi ƒê·∫°i s·ªë Tuy·∫øn t√≠nh",
    description: "ƒê·ªÅ thi gi·ªØa k·ª≥ m√¥n ƒê·∫°i s·ªë Tuy·∫øn t√≠nh d√†nh cho sinh vi√™n kh·ªëi ng√†nh To√°n - Tin",
    fileName: "linear_algebra_midterm.pdf",
    major: "To√°n",
    createdDate: "2025-06-11T14:20:00Z",
    status: "pending",
  },
  {
    id: "12",
    title: "ƒê·ªÅ thi Nhi·ªát ƒë·ªông h·ªçc",
    description: "ƒê·ªÅ thi cu·ªëi k·ª≥ m√¥n Nhi·ªát ƒë·ªông h·ªçc cho sinh vi√™n ng√†nh K·ªπ thu·∫≠t C∆° kh√≠",
    fileName: "thermodynamics_final.pdf",
    major: "L√Ω",
    createdDate: "2025-06-12T09:00:00Z",
    status: "approved",
  },
  {
    id: "13",
    title: "ƒê·ªÅ thi H√≥a h·ªçc H·ªØu c∆°",
    description: "ƒê·ªÅ thi gi·ªØa k·ª≥ m√¥n H√≥a h·ªçc H·ªØu c∆° d√†nh cho sinh vi√™n nƒÉm th·ª© ba khoa H√≥a",
    fileName: "organic_chemistry_midterm.pdf",
    major: "H√≥a",
    createdDate: "2025-06-13T16:30:00Z",
    status: "draft",
  },
  {
    id: "14",
    title: "ƒê·ªÅ thi L√Ω thuy·∫øt VƒÉn h·ªçc",
    description: "ƒê·ªÅ thi cu·ªëi k·ª≥ m√¥n L√Ω thuy·∫øt VƒÉn h·ªçc - M√¥n c∆° s·ªü ng√†nh Ng·ªØ vƒÉn",
    fileName: "literary_theory_final.pdf",
    major: "VƒÉn",
    createdDate: "2025-06-14T11:45:00Z",
    status: "pending",
  },
  {
    id: "15",
    title: "ƒê·ªÅ thi Kh√≠ t∆∞·ª£ng h·ªçc",
    description: "ƒê·ªÅ thi cu·ªëi k·ª≥ m√¥n Kh√≠ t∆∞·ª£ng h·ªçc cho sinh vi√™n chuy√™n ng√†nh ƒê·ªãa l√Ω T·ª± nhi√™n",
    fileName: "meteorology_final.pdf",
    major: "ƒê·ªãa",
    createdDate: "2025-06-15T13:25:00Z",
    status: "approved",
  }
];
    dispatch(setExams(fakeExams));
    message.success('Danh s√°ch ƒë·ªÅ thi ƒë√£ ƒë∆∞·ª£c ƒë·∫∑t l·∫°i v·ªõi d·ªØ li·ªáu m·∫´u.');
  };

  return (
    <div className="min-h-screen bg-gray-50 p-6">
      <div className="max-w-7xl mx-auto">
        {/* Header Section */}
        <Card className="mb-6 shadow-sm">
          <div className="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4">
            <div>
              <Title level={2} className="mb-2 text-gray-800">
                <FileTextOutlined className="mr-3" />
                Qu·∫£n l√Ω ƒê·ªÅ thi
              </Title>
              <Text type="secondary" className="text-base">
                Qu·∫£n l√Ω v√† t·ªï ch·ª©c c√°c ƒë·ªÅ thi, b√†i ki·ªÉm tra m·ªôt c√°ch hi·ªáu qu·∫£
              </Text>
            </div>
            <Space>
              <Button
                type="primary"
                icon={<PlusOutlined />}
                onClick={() => { 
                  setIsModalVisible(true); 
                  setEditingExam(null); 
                  form.resetFields(); 
                }}
                size="large"
                className="bg-blue-600 hover:bg-blue-700"
              >
                Th√™m ƒë·ªÅ m·ªõi
              </Button>
              <Button
                icon={<ReloadOutlined />}
                onClick={handleResetExams}
                size="large"
              >
                D·ªØ li·ªáu m·∫´u
              </Button>
            </Space>
          </div>
        </Card>

        {/* Filter Section */}
        <Card className="mb-6 shadow-sm">
          <Row gutter={[16, 16]}>
            <Col xs={24} sm={12} lg={8}>
              <div className="space-y-2">
                <Text strong className="text-gray-700">
                  <SearchOutlined className="mr-2" />
                  T√¨m ki·∫øm
                </Text>
                <Search
                  placeholder="T√¨m ki·∫øm theo ti√™u ƒë·ªÅ, m√¥ t·∫£, m√¥n h·ªçc..."
                  onSearch={(value) => dispatch(setFilter({ searchTerm: value }))}
                  onChange={(e) => dispatch(setFilter({ searchTerm: e.target.value }))}
                  size="large"
                  allowClear
                />
              </div>
            </Col>
            <Col xs={24} sm={12} lg={8}>
              <div className="space-y-2">
                <Text strong className="text-gray-700">
                  <FilterOutlined className="mr-2" />
                  Tr·∫°ng th√°i
                </Text>
                <Select
                  value={filterStatus}
                  onChange={handleFilterChange}
                  style={{ width: '100%' }}
                  placeholder="L·ªçc theo tr·∫°ng th√°i"
                  size="large"
                >
                  <Select.Option value="all">T·∫•t c·∫£ tr·∫°ng th√°i</Select.Option>
                  <Select.Option value="draft">
                    <Badge color="#faad14" text="Nh√°p" />
                  </Select.Option>
                  <Select.Option value="pending">
                    <Badge color="#1890ff" text="ƒêang x·ª≠ l√Ω" />
                  </Select.Option>
                  <Select.Option value="approved">
                    <Badge color="#52c41a" text="ƒê√£ duy·ªát" />
                  </Select.Option>
                </Select>
              </div>
            </Col>
            <Col xs={24} sm={12} lg={8}>
              <div className="space-y-2">
                <Text strong className="text-gray-700">
                  <BookOutlined className="mr-2" />
                  M√¥n h·ªçc
                </Text>
                <Select
                  value={filterMajor}
                  onChange={handleMajorFilterChange}
                  style={{ width: '100%' }}
                  placeholder="L·ªçc theo m√¥n h·ªçc"
                  size="large"
                  allowClear
                >
                  {majorOptions.map(option => (
                    <Select.Option key={option.value} value={option.value}>
                      {option.label}
                    </Select.Option>
                  ))}
                </Select>
              </div>
            </Col>
          </Row>
        </Card>

        {/* Table Section */}
        <Card className="shadow-sm">
          <Table
            columns={columns}
            dataSource={filteredExams}
            loading={loading}
            rowKey="id"
            pagination={{
              current: pagination.current,
              pageSize: pagination.pageSize,
              total: pagination.total,
              onChange: (page, pageSize) => dispatch(setPagination({ current: page, pageSize })),
              showSizeChanger: true,
              pageSizeOptions: ['5', '10', '20', '50'],
              showQuickJumper: true,
              showTotal: (total, range) => 
                `${range[0]}-${range[1]} c·ªßa ${total} ƒë·ªÅ thi`,
            }}
            scroll={{ x: 1200 }}
            size="middle"
            className="custom-table"
            rowClassName={(_record, index) => 
              index % 2 === 0 ? 'table-row-light' : 'table-row-dark'
            }
          />
        </Card>

        {/* Modal Section */}
        <Modal
          title={
            <Space>
              {editingExam ? <EditOutlined /> : <PlusOutlined />}
              {editingExam ? 'Ch·ªânh s·ª≠a ƒë·ªÅ thi' : 'Th√™m ƒë·ªÅ thi m·ªõi'}
            </Space>
          }
          open={isModalVisible}
          onCancel={() => { 
            setIsModalVisible(false); 
            setEditingExam(null); 
            form.resetFields(); 
          }}
          footer={null}
          width={700}
          className="custom-modal"
        >
          <Divider />
          <Spin spinning={formLoading}>
            <Form
              form={form}
              onFinish={handleAddOrUpdate}
              layout="vertical"
              initialValues={editingExam || {}}
              className="space-y-4"
            >
              <Row gutter={16}>
                <Col span={24}>
                  <Form.Item 
                    name="title" 
                    label={<Text strong>Ti√™u ƒë·ªÅ ƒë·ªÅ thi</Text>}
                    rules={[{ required: true, message: 'Vui l√≤ng nh·∫≠p ti√™u ƒë·ªÅ!' }]}
                  >
                    <Input size="large" placeholder="Nh·∫≠p ti√™u ƒë·ªÅ ƒë·ªÅ thi..." />
                  </Form.Item>
                </Col>
              </Row>

              <Row gutter={16}>
                <Col span={24}>
                  <Form.Item 
                    name="description" 
                    label={<Text strong>M√¥ t·∫£</Text>}
                    rules={[{ required: true, message: 'Vui l√≤ng nh·∫≠p m√¥ t·∫£!' }]}
                  >
                    <TextArea 
                      rows={4} 
                      size="large" 
                      placeholder="Nh·∫≠p m√¥ t·∫£ chi ti·∫øt v·ªÅ ƒë·ªÅ thi..."
                    />
                  </Form.Item>
                </Col>
              </Row>

              <Row gutter={16}>
                <Col xs={24} sm={12}>
                  <Form.Item 
                    name="major" 
                    label={<Text strong>M√¥n h·ªçc</Text>}
                    rules={[{ required: true, message: 'Vui l√≤ng ch·ªçn m√¥n h·ªçc!' }]}
                  >
                    <Select size="large" placeholder="Ch·ªçn m√¥n h·ªçc">
                      {majorOptions.map(option => (
                        <Select.Option key={option.value} value={option.value}>
                          {option.label}
                        </Select.Option>
                      ))}
                    </Select>
                  </Form.Item>
                </Col>
                <Col xs={24} sm={12}>
                  <Form.Item 
                    name="status" 
                    label={<Text strong>Tr·∫°ng th√°i</Text>}
                    rules={[{ required: true, message: 'Vui l√≤ng ch·ªçn tr·∫°ng th√°i!' }]}
                  >
                    <Select size="large" placeholder="Ch·ªçn tr·∫°ng th√°i">
                      <Select.Option value="draft">
                        <Badge color="#faad14" text="Nh√°p" />
                      </Select.Option>
                      <Select.Option value="pending">
                        <Badge color="#1890ff" text="ƒêang x·ª≠ l√Ω" />
                      </Select.Option>
                      <Select.Option value="approved">
                        <Badge color="#52c41a" text="ƒê√£ duy·ªát" />
                      </Select.Option>
                    </Select>
                  </Form.Item>
                </Col>
              </Row>

              <Row gutter={16}>
                <Col span={24}>
                  <Form.Item 
                    name="file" 
                    label={<Text strong>T·ªáp ƒë·ªÅ thi</Text>}
                    rules={[{ required: !editingExam, message: 'Vui l√≤ng ch·ªçn t·ªáp!' }]}
                  >
                    <Upload.Dragger
                      name="file"
                      multiple={false}
                      beforeUpload={() => false}
                      onChange={(info) => {
                        form.setFieldsValue({ file: info.fileList[0] });
                      }}
                    >
                      <p className="ant-upload-drag-icon">
                        <UploadOutlined style={{ fontSize: '48px', color: '#1890ff' }} />
                      </p>
                      <p className="ant-upload-text">
                        Nh·∫•p ho·∫∑c k√©o t·ªáp v√†o khu v·ª±c n√†y ƒë·ªÉ t·∫£i l√™n
                      </p>
                      <p className="ant-upload-hint">
                        H·ªó tr·ª£ ƒë·ªãnh d·∫°ng: PDF, DOC, DOCX (T·ªëi ƒëa 10MB)
                      </p>
                    </Upload.Dragger>
                  </Form.Item>
                </Col>
              </Row>

              <Divider />

              <Row justify="end">
                <Space>
                  <Button 
                    size="large"
                    onClick={() => { 
                      setIsModalVisible(false); 
                      form.resetFields(); 
                    }}
                  >
                    H·ªßy
                  </Button>
                  <Button 
                    type="primary" 
                    htmlType="submit" 
                    size="large" 
                    loading={formLoading}
                    className="bg-blue-600 hover:bg-blue-700"
                  >
                    {editingExam ? 'C·∫≠p nh·∫≠t' : 'Th√™m m·ªõi'}
                  </Button>
                </Space>
              </Row>
            </Form>
          </Spin>
        </Modal>
      </div>

    </div>
  );
};

export default ExamList;